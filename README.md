# Tinkoff-Lab
Отбор в Tinkoff Lab. Лабораторная работа "Генерация жестов рук".

## Task 1 (Идентификация спикеров)

Решение:

Все мы знаем, что звуковую дорожку можно перевести в формат спектрограммы, чем собственно и будем заниматься. По сути решение заключается в получении мел-спектрограммы, которую потом можно использовать для обучения классической сверточной модели, будто это картинка. 

Теперь подробнее:

    - Обработка звуковой дорожки:
        * Считали в numpy(torch)-массив
        * Привели в единообразное состояние (то есть просто удлинили/обрезали до 5 секунд, ибо остальные параметры константны)
        * Применили аугментации(-ю) - сдвиг по времени
        * Получили мел-спектрограмму
        
    - Модель:
        * Пять сверток с ReLU в качестве функций активации и нормализацией по батчу
        * Пулинг среднего
        * Линейный слой
        
    - Обучение:
        * Кросс-энтропия как функция потерь
        * Адам как оптимизатор
        * Точность в качестве метрики
        * Планировщик для красоты
        
Результаты:

На ранее невиданных моделью репликах собственно модель показала результаты близкие к идеальным, что символизирует успешность выбранного подхода даже на достаточно небольшом количестве данных (всего 500 реплик для обучения)

## Task 2 (Сглаживание анимации)

Скрипт pose_extractor.py:

1) parse_video извлекает информацию из видео с помощью MediaPipe. Возвращает pose_landmarks, timestamps - покадровые landmarks и соответствующие метки времени.
2) get_all_landmarks возвращает landmarks в виде 

[
 {"name_1" : {"x": 0, "y": 0, "z": 0},
  "name_2" : {"x": 0, "y": 0, "z": 0},
  "name_3" : {"x": 0, "y": 0, "z": 0},
   ...},
 {"name_1" : {"x": 0, "y": 0, "z": 0},
  "name_2" : {"x": 0, "y": 0, "z": 0},
  "name_3" : {"x": 0, "y": 0, "z": 0},
   ...},
...
]

3) smoothing - сглаживает неудачные кадры (берём среднее по соседям)
4) add_dummy_vertices - добавляем фиктивные вершины, чтобы получить скелет-дерево (основание шеи как среднее между плечами и низ позвоночника как среднее между бёдрами)
5) get_all_landmarks_angular_coordinate возвращает угловые координаты суставов
6) Далее полученную информацию сохраняем в файл

В ноутбуке Task_2 можно найти визуализацию с помощью matplotlib кадров из видео panoptic_sample.mp4
